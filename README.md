# tinkoff-invest-volume-profile-robot
## Робот на основе профиля рынка для Тинькофф Инвестиций

### Установка
```
$ pip install -r ./requirements.txt
```

анализируются активы, ордера выставляются на фьючерсе

### Преимущества робота
- кластерный анализ и профиль рынка позволяет определить интерес игроков;
- стратегия дает х% прибыльности (результат на основе тестирования истории с 04-05-22 по 20-05-22);

### Возможности робота
- накопление истории по обезличенным сделкам по указанным инструментам;
- тестирование алгоритма на истории* (без учета комиссии и проскальзываний);
- просмотр результата анализа на графике;
- восстановление данных за промежуток времени при сбоях;
- анализ актива и торговля его фьючерса в реальном времени;
- управление настройками алгоритма и возможность его полной замены;
- выступать в роли робота с открытием позиций или только советника;

### Алгоритм 
1. Строим объемные уровни за выбранный ТФ.
2. Если цена, через заданный промежуток времени, подходит к одному из объемных уровней:
- сверху вниз, то рассматривается ТВ в лонг;
- снизу вверх, то рассматривается ТВ в шорт.
5. Если сформировалась ТВ, то анализируем предыдущую закрытую 5-минутную свечу:
- если в свече преобладают лонгисты и максимальный объем свечи снизу, то открывается позиция в лонг; 
- если в свече преобладают шортисты и максимальный объем свечи сверху, то открывается позиция в шорт.
5. Устанавливается S/L и T/P в соответствии с заданными настройками.
6. Осуществляется уведомление через telegram-бота.

### Параметры робота
| Свойство          | Описание                            | Рекомендованные значения |
|-------------------|-------------------------------------|--------------------------|
| TOKEN             | Токен профиля в Тинькофф Инвестиций | -                        |
| INSTRUMENTS       | Массив анализируемых инструментов   | -                        |
| CURRENT_TIMEFRAME | ТФ для профиля рынка                | 1h                       |


### Планы по развитию

#### Минимизировать риски стратегии
- текущие настройки алгоритма часто дают убыточные сделки в боковике; 
- провести более подробное тестирование истории на разных параметрах: ТФ свечей, ТФ объемных уровней;

#### Архитектура
- хранение данных в файлах оказалось не лучшим решением (todo причины)
- оптимизировать расчеты стратегии:
  - тестирование истории 1 инструмента за 1 день занимает от 1 до 5 минут;
  - в случае сбоя приложения и повторного запуска, стенд с 1 ядром нагружается до 99% (за счет загрузки и объединении истории);

#### Реализовать алгоритмы
- вход по тренду с ориентированием на максимальный объем текущего дня;
- вход против тренда с ориентированием на максимальный объем текущего дня;
- реакция на максимальный горизонтальный объем предыдущего дня;
- вход на обновление минимума/максимума текущего дня / предыдущих дней.

#### Управление позицией
- закрывать позицию частями;
- добавить трейлинг-стоп;
- открывать позицию частями: по рынку и лимитными ордерами;
- закрывать позицию полностью, если ситуация на рынке изменилась на противоположную;
- входить на повышенный/уменьшенный объем, если алгоритм дает идеальные/слабые условия;

#### Удобство взаимодействия
- реализовать api для робота;
- реализовать web-интерфейс;